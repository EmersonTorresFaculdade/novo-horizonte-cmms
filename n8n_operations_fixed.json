[{"type":"updateNode","nodeName":"Admin WhatsApp","updates":{"parameters":{"bodyParameters":{"parameters":[{"name":"number","value":"={{ $json.adminPhoneToUse }}"},{"name":"text","value":"={{ 'ğŸ”” *Novo Horizonte CMMS*\\nğŸ“ *' + ($json.body.event == 'work_order_created' ? 'ğŸ†• Nova Ordem de ServiÃ§o' : 'ğŸ”„ AtualizaÃ§Ã£o de Ordem de ServiÃ§o') + ' #' + ($json.body.workOrder.order_number || $json.body.workOrder.osNumber || 'N/A') + '*\\n\\nğŸ­ *MÃ¡quina:* ' + ($json.body.workOrder.assetName || 'N/A') + '\\nğŸ“‚ *Falha:* ' + ($json.body.failure_type || 'N/A') + '\\nğŸ› ï¸ *Classe:* ' + ($json.body.workOrder.maintenance_type || 'N/A') + '\\nâ³ *T. Estimado:* ' + (($json.body.workOrder.estimated_hours !== undefined && $json.body.workOrder.estimated_hours !== null) ? $json.body.workOrder.estimated_hours + 'h' : 'N/A') + '\\n\\nğŸ“„ *DescriÃ§Ã£o:* ' + $json.body.workOrder.description + '\\nğŸš¦ *Status:* ' + $json.body.workOrder.status + '\\nğŸš¨ *Prioridade:* ' + $json.body.workOrder.priority + '\\nğŸ‘¨â€ğŸ”§ *TÃ©cnico:* ' + ($json.body.workOrder.technicianName || 'Pendente') + '\\nğŸ‘¤ *Solicitante:* ' + ($json.body.requesterName || $json.body.requesterEmail) + ($json.body.technical_report ? '\\n\\nğŸ› ï¸ *RelatÃ³rio TÃ©cnico:*\\n' + $json.body.technical_report : '') + '\\n\\nğŸ”— ' + ($json.body.workOrder.url || ('https://manutencao.novohorizonte.com/#/work-orders/' + $json.body.workOrder.id)) }}"}]}}}},{"type":"updateNode","nodeName":"Requester WhatsApp","updates":{"parameters":{"bodyParameters":{"parameters":[{"name":"number","value":"={{ $json.body.requesterPhone }}"},{"name":"text","value":"={{ 'ğŸ”” *Novo Horizonte CMMS*\\nğŸ“ *' + ($json.body.event == 'work_order_created' ? 'ğŸ†• Nova Ordem de ServiÃ§o' : 'ğŸ”„ AtualizaÃ§Ã£o de Ordem de ServiÃ§o') + ' #' + ($json.body.workOrder.order_number || $json.body.workOrder.osNumber || 'N/A') + '*\\n\\nOlÃ¡, ' + ($json.body.requesterName || 'Solicitante') + '!\\nSua ordem de serviÃ§o foi ' + ($json.body.event == 'work_order_created' ? 'criada' : 'atualizada') + '. ğŸ‘‡\\n\\nğŸ­ *MÃ¡quina:* ' + ($json.body.workOrder.assetName || 'N/A') + '\\nğŸ“‚ *Falha:* ' + ($json.body.failure_type || 'N/A') + '\\nğŸ› ï¸ *Classe:* ' + ($json.body.workOrder.maintenance_type || 'N/A') + '\\nâ³ *T. Estimado:* ' + (($json.body.workOrder.estimated_hours !== undefined && $json.body.workOrder.estimated_hours !== null) ? $json.body.workOrder.estimated_hours + 'h' : 'N/A') + '\\nğŸ“„ *DescriÃ§Ã£o:* ' + $json.body.workOrder.description + '\\nğŸš¦ *Status:* ' + $json.body.workOrder.status + '\\nğŸ‘¨â€ğŸ”§ *TÃ©cnico:* ' + ($json.body.workOrder.technicianName || 'Pendente') + ($json.body.technical_report ? '\\nğŸ› ï¸ *RelatÃ³rio TÃ©cnico:*\\n' + $json.body.technical_report : '') + '\\n\\nğŸ”— Acompanhe aqui: ' + ($json.body.workOrder.url || ('https://manutencao.novohorizonte.com/#/work-orders/' + $json.body.workOrder.id)) }}"}]}}}},{"type":"updateNode","nodeName":"Admin Email","updates":{"parameters":{"html":"={{ '<!DOCTYPE html><html><head><meta charset=\\\"UTF-8\\\"><title>NotificaÃ§Ã£o CMMS</title><style>body{margin:0;padding:0;background:#F4F6F8;font-family:Arial,Helvetica,sans-serif;}.container{max-width:640px;margin:40px auto;background:#ffffff;border-radius:12px;overflow:hidden;box-shadow:0 12px 35px rgba(0,0,0,0.08);}.header{background:#1C1F24;color:#ffffff;padding:30px;text-align:center;}.header h1{margin:0;font-size:20px;font-weight:600;}.header span{color:#1F7A4C;}.content{padding:30px;}.intro{font-size:15px;color:#444;margin-bottom:25px;}.card{background:#F9FBFC;border-left:5px solid #1F7A4C;padding:22px;border-radius:8px;}.field{margin-bottom:18px;}.label{font-size:12px;text-transform:uppercase;color:#8a8f98;margin-bottom:5px;font-weight:600;}.value{font-size:15px;font-weight:600;color:#1C1F24;}.badge{background:#E6F4EC;color:#1F7A4C;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;display:inline-block;}.priority{color:#D84315;}.button-container{text-align:center;margin-top:30px;}.button{display:inline-block;padding:14px 28px;background:#1F7A4C;color:#ffffff;text-decoration:none;border-radius:8px;font-size:15px;font-weight:600;}.footer{background:#1C1F24;color:#b5bcc6;padding:18px;text-align:center;font-size:12px;}</style></head><body><div class=\\\"container\\\"><div class=\\\"header\\\"><h1>' + ($json.body.event == 'work_order_created' ? 'ğŸ†• Nova Ordem de ServiÃ§o' : 'ğŸ”„ AtualizaÃ§Ã£o da Ordem de ServiÃ§o') + ' <span>#' + ($json.body.workOrder.order_number || $json.body.workOrder.osNumber || 'N/A') + '</span></h1></div><div class=\\\"content\\\"><p class=\\\"intro\\\">OlÃ¡ <strong>Administrador</strong>, um evento foi registrado no sistema CMMS. Veja os detalhes abaixo:</p><div class=\\\"card\\\"><div class=\\\"field\\\"><div class=\\\"label\\\">TÃ­tulo / DescriÃ§Ã£o</div><div class=\\\"value\\\">' + ($json.body.workOrder.title || $json.body.workOrder.description || 'NÃ£o informado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">MÃ¡quina / Ativo</div><div class=\\\"value\\\">' + ($json.body.workOrder.assetName ? $json.body.workOrder.assetName : 'NÃ£o informado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Tipo de Falha</div><div class=\\\"value\\\">' + ($json.body.failure_type || 'NÃ£o especificado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Classe de ManutenÃ§Ã£o</div><div class=\\\"value\\\">' + ($json.body.workOrder.maintenance_type || 'NÃ£o especificada') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Tempo Estimado</div><div class=\\\"value\\\">' + (($json.body.workOrder.estimated_hours !== undefined && $json.body.workOrder.estimated_hours !== null) ? $json.body.workOrder.estimated_hours + 'h' : 'NÃ£o especificado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Status</div><div class=\\\"value\\\"><span class=\\\"badge\\\">' + ($json.body.workOrder.status || 'N/A') + '</span></div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Prioridade</div><div class=\\\"value priority\\\">' + ($json.body.workOrder.priority || 'N/A') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">TÃ©cnico ResponsÃ¡vel</div><div class=\\\"value\\\">' + ($json.body.workOrder.technicianName && $json.body.workOrder.technicianName !== 'Pendente' && $json.body.workOrder.technicianName !== 'Aguardando' ? $json.body.workOrder.technicianName : 'NÃ£o atribuÃ­do') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Solicitante</div><div class=\\\"value\\\">' + ($json.body.requesterName || $json.body.requesterEmail || 'NÃ£o informado') + '</div></div><div class=\\\"field\\\" style=\\\"' + ($json.body.technical_report ? 'display:block;' : 'display:none;') + '\\\"><div class=\\\"label\\\">RelatÃ³rio TÃ©cnico</div><div class=\\\"value\\\" style=\\\"white-space:pre-wrap;background:#f8f9fa;padding:10px;border:1px solid #eee\\\">' + ($json.body.technical_report || '') + '</div></div></div><div class=\\\"button-container\\\"><a href=\\\"' + ($json.body.workOrder.url || ('https://manutencao.novohorizonte.com/#/work-orders/' + $json.body.workOrder.id)) + '\\\" class=\\\"button\\\">Acessar Ordem de ServiÃ§o</a></div></div><div class=\\\"footer\\\">Novo Horizonte CMMS â€¢ GestÃ£o de ManutenÃ§Ã£o<br>Â© 2026 Novo Horizonte</div></div></body></html>' }}"}}},{"type":"updateNode","nodeName":"Send Requester Email","updates":{"parameters":{"html":"={{ '<!DOCTYPE html><html><head><meta charset=\\\"UTF-8\\\"><title>NotificaÃ§Ã£o CMMS</title><style>body{margin:0;padding:0;background:#F4F6F8;font-family:Arial,Helvetica,sans-serif;}.container{max-width:640px;margin:40px auto;background:#ffffff;border-radius:12px;overflow:hidden;box-shadow:0 12px 35px rgba(0,0,0,0.08);}.header{background:#1C1F24;color:#ffffff;padding:30px;text-align:center;}.header h1{margin:0;font-size:20px;font-weight:600;}.header span{color:#1F7A4C;}.content{padding:30px;}.intro{font-size:15px;color:#444;margin-bottom:25px;}.card{background:#F9FBFC;border-left:5px solid #1F7A4C;padding:22px;border-radius:8px;}.field{margin-bottom:18px;}.label{font-size:12px;text-transform:uppercase;color:#8a8f98;margin-bottom:5px;font-weight:600;}.value{font-size:15px;font-weight:600;color:#1C1F24;}.badge{background:#E6F4EC;color:#1F7A4C;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:600;display:inline-block;}.priority{color:#D84315;}.button-container{text-align:center;margin-top:30px;}.button{display:inline-block;padding:14px 28px;background:#1F7A4C;color:#ffffff;text-decoration:none;border-radius:8px;font-size:15px;font-weight:600;}.footer{background:#1C1F24;color:#b5bcc6;padding:18px;text-align:center;font-size:12px;}</style></head><body><div class=\\\"container\\\"><div class=\\\"header\\\"><h1>' + ($json.body.event == 'work_order_created' ? 'ğŸ†• Nova Ordem de ServiÃ§o' : 'ğŸ”„ AtualizaÃ§Ã£o da Ordem de ServiÃ§o') + ' <span>#' + ($json.body.workOrder.order_number || $json.body.workOrder.osNumber || 'N/A') + '</span></h1></div><div class=\\\"content\\\"><p class=\\\"intro\\\">OlÃ¡ <strong>' + ($json.body.requesterName || 'Solicitante') + '</strong>, sua ordem de serviÃ§o foi ' + ($json.body.event == 'work_order_created' ? 'criada' : 'atualizada') + ' no sistema CMMS. Veja os detalhes abaixo:</p><div class=\\\"card\\\"><div class=\\\"field\\\"><div class=\\\"label\\\">TÃ­tulo / DescriÃ§Ã£o</div><div class=\\\"value\\\">' + ($json.body.workOrder.title || $json.body.workOrder.description || 'NÃ£o informado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">MÃ¡quina / Ativo</div><div class=\\\"value\\\">' + ($json.body.workOrder.assetName ? $json.body.workOrder.assetName : 'NÃ£o informado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Tipo de Falha</div><div class=\\\"value\\\">' + ($json.body.failure_type || 'NÃ£o especificado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Classe de ManutenÃ§Ã£o</div><div class=\\\"value\\\">' + ($json.body.workOrder.maintenance_type || 'NÃ£o especificada') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Tempo Estimado</div><div class=\\\"value\\\">' + (($json.body.workOrder.estimated_hours !== undefined && $json.body.workOrder.estimated_hours !== null) ? $json.body.workOrder.estimated_hours + 'h' : 'NÃ£o especificado') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Novo Status</div><div class=\\\"value\\\"><span class=\\\"badge\\\">' + ($json.body.workOrder.status || 'N/A') + '</span></div></div><div class=\\\"field\\\"><div class=\\\"label\\\">Prioridade</div><div class=\\\"value priority\\\">' + ($json.body.workOrder.priority || 'N/A') + '</div></div><div class=\\\"field\\\"><div class=\\\"label\\\">TÃ©cnico ResponsÃ¡vel</div><div class=\\\"value\\\">' + ($json.body.workOrder.technicianName && $json.body.workOrder.technicianName !== 'Pendente' && $json.body.workOrder.technicianName !== 'Aguardando' ? $json.body.workOrder.technicianName : 'NÃ£o atribuÃ­do') + '</div></div><div class=\\\"field\\\" style=\\\"' + ($json.body.technical_report ? 'display:block;' : 'display:none;') + '\\\"><div class=\\\"label\\\">RelatÃ³rio TÃ©cnico</div><div class=\\\"value\\\" style=\\\"white-space:pre-wrap;background:#f8f9fa;padding:10px;border:1px solid #eee\\\">' + ($json.body.technical_report || '') + '</div></div></div><div class=\\\"button-container\\\"><a href=\\\"' + ($json.body.workOrder.url || ('https://manutencao.novohorizonte.com/#/work-orders/' + $json.body.workOrder.id)) + '\\\" class=\\\"button\\\">Ver Detalhes da OS</a></div></div><div class=\\\"footer\\\">Novo Horizonte CMMS â€¢ Fique por dentro!<br>Â© 2026 Novo Horizonte</div></div></body></html>' }}"}}}]